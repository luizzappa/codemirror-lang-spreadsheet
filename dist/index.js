import { ExternalTokenizer, LRParser } from '@lezer/lr';
import { LRLanguage, indentNodeProp, delimitedIndent, foldNodeProp, foldInside, LanguageSupport } from '@codemirror/language';
import { styleTags, tags } from '@lezer/highlight';

// This file was generated by lezer-generator. You probably shouldn't edit it.
const intersecop = 36,
  BoolToken = 1;

/* Hand-written tokenizers for excel formula tokens that can't be
  expressed by lezer's built-in tokenizer (or are harder to express). */
let currIdiom = "en-US";
// Always uppercase
const i18n = {
    "BoolToken": {
        "en-US": ["TRUE", "FALSE"],
        "pt-BR": ["VERDADEIRO", "FALSO"]
    }
};
const openParen = 40, closeParen = 41, backSlash = 92, underscore = 95, dot = 46, questionMark = 63, euroSign = 8364, isSpace = (charCode) => {
    return ([
        9, 10, 11, 12, 13, 32, 133, 160, 5760, 8192, 8193, 8194, 8195, 8196,
        8197, 8198, 8199, 8200, 8201, 8202, 8232, 8233, 8239, 8287, 12288
    ].indexOf(charCode) !== -1);
}, isDigit = (charCode) => charCode >= 48 && charCode <= 57, isAsciiLeter = (charCode) => {
    return ((charCode >= 65 && charCode <= 90) || (charCode >= 97 && charCode <= 122));
};
const isIntersecop = new ExternalTokenizer((input, stack) => {
    let { next } = input, before;
    if (!isSpace(next) &&
        ((before = input.peek(-1)) !== closeParen ||
            !isDigit(before) ||
            !isAsciiLeter(before) ||
            before !== backSlash ||
            before !== underscore ||
            before !== dot ||
            before !== questionMark ||
            before !== euroSign))
        return;
    for (;;) {
        next = input.advance();
        if (!isSpace(next))
            break;
    }
    if (next === openParen ||
        isAsciiLeter(next) ||
        before === backSlash ||
        before === underscore)
        return input.acceptToken(intersecop);
}, { contextual: true });
const isBoolean = (value, stack) => {
    return i18n.BoolToken[currIdiom].indexOf(value.toUpperCase()) !== -1
        ? BoolToken
        : -1;
};
const setIdiom = (newIdiom) => currIdiom = newIdiom;

// This file was generated by lezer-generator. You probably shouldn't edit it.
const parser = LRParser.deserialize({
  version: 14,
  states: "+^O!^QQOOOOQP'#C`'#C`O!hQTO'#C`O$XQRO'#DVO%fQQO'#CfO&qQTO'#DWOOQO'#D['#D[O'RQWO'#D[OOQP'#C_'#C_O'ZQQO'#C_OOQO'#Co'#CoO(gQQO'#DTO(nQQO'#CsO%fQQO'#CsOOQO'#Cs'#CsO)gQQO'#CwOOQO'#DV'#DVOOQO'#DT'#DTQOQQOOO%fQQO'#DTO)nQQO,59QO)nQQO,59QO*]QTO,59rO*gQQO,59QO*lQQO,59qO({QQO'#CwOOQP,59Q,59QOOQO,59v,59vOOQP,58y,58yO%fQQO,59{O%fQQO,59{O%fQQO,59{O%fQQO,59{O%fQQO,59{OOQO,59_,59_O*sQQO'#CvO*}QQO'#CuO+VQQO,59_O+[QQO,59_OOQO'#Dl'#DlOOQO'#Cz'#CzO+lQQO'#CzO+qQQO'#CyO+|QQO'#CxO,UQQO,59cO%fQQO,5:ZO,ZQQO,59oOOQP1G.l1G.lO)nQQO'#CfO,bQTO1G.lO)nQQO'#C{O-rQQO,59SOOQP1G/^1G/^OOQO1G/]1G/]O/OQQO1G/gO/VQQO1G/gO0_QQO1G/gO0iQQO1G/gO1[QQO1G/gO(nQQO'#C|O2OQQO,59aOOQO1G.y1G.yOOQO,59f,59fO({QQO'#C}O2WQQO,59eO({QQO'#DOO2cQQO,59dOOQO1G.}1G.}O2kQQO1G/uO2rQRO'#CfO2zQTO,59gOOQO-E6y-E6yOOQO,59h,59hOOQO-E6z-E6zOOQO,59i,59iOOQO-E6{-E6{OOQO,59j,59jOOQO-E6|-E6|OOQO7+%a7+%a",
  stateData: "3m~OvOS~OPYOTPOUPOVPOWPOXQOZSO^UO_VOaUOdYOeYOfYOh[O!P]O!Q]O!R]O~OxcO!__O~PVOT!OXU!OXV!OXW!OXX!OXsSXtSXxSX{SX}SX!PSX!QSX!SSX!USX!VSX!WSX!XSX!YSX!ZSX![SX!]SX!^SX]SX|SX!bSX~OteO{dOsyXxyX!PyX!QyX!SyX!UyX!VyX!WyX!XyX!YyX!ZyX![yX!]yX!^yX]yX|yX!byX~O!_iO~PVO}jOtzXxzX{zX!PzX!QzX!SzX!UzX!VzX!WzX!XzX!YzX!ZzX![zX!]zX!^zX~OszX]zX|zX!bzX~P%mO`kObkO~OTPOUPOVPOWPOXPO~OxqO!PoO!QoO!SrO!UmO!VnO!WnO!XpO!YqO!ZqO![qO!]qO!^qO~OswX~P'lO!_iO]jP|jP~PVOPYOXxOdYOeYOfYO!PwO!QwO!RwO~Ox}O~P({OTPOUPOVPOWPOXQOZ!QO^UO_VOaUO~O]!UO|!SO~P%mO]!PO~O]!VO~P'lO]jX|jX~P'lO|!]O]iX~O]!_O~Osga]ga|ga!bga~P'lOd!`O~O|!aO!amX!bmX~O!a!cO!blX~O!b!eO~Oswa~P'lO{dOsYitYixYi}Yi!PYi!QYi!SYi!UYi!VYi!WYi!XYi!YYi!ZYi![Yi!]Yi!^Yi]Yi|Yi!bYi~O|!SO][a~O!SrOs!Tix!Ti!P!Ti!Q!Ti!V!Ti!W!Ti!X!Ti!Y!Ti!Z!Ti![!Ti!]!Ti!^!Ti]!Ti|!Ti!b!Ti~O!U!Ti~P-zO!UmO~P-zO!SrO!UmO!VnO!WnOs!Tix!Ti!X!Ti!Y!Ti!Z!Ti![!Ti!]!Ti!^!Ti]!Ti|!Ti!b!Ti~O!P!Ti!Q!Ti~P/^O!PoO!QoO~P/^O!PoO!QoO!SrO!UmO!VnO!WnO!XpO~Os!Tix!Ti!Y!Ti!Z!Ti![!Ti!]!Ti!^!Ti]!Ti|!Ti!b!Ti~P0sO|!]O]ia~O|!aO!ama!bma~O!a!cO!bla~O!b!pO~P'lOteO{dO~O}jO]oatzX{zX|oa~OWb`ae^dhVTU!R!Pvh~",
  goto: "'|!dPPP!e!{PPPPP#bP#tPPPPPP#xPPP$^P$l$o$^$u$y%Q%Y%`%f%lPPPP%rP%u&iPPP'RPPPP'ePPPPPPPPPP'sPP'yjTO[]cdemnopq}!]SfS!QR!h!SpWOS[]cdemnopq}!Q!S!]RlXqWOS[]cdemnopq}!Q!S!]TgS!Qh`OS[]cmnopq}!]Xx_i!a!ci`OS[]cmnopq}!]Ru[Qt[R!j!]T|_iS{_iR!n!cUz_i!cR!l!aQ!TfR!i!TQ!^tR!k!^Q!bzR!m!bQ!d{R!o!dRbOQZOQhSSs[!]Qv]Q!OcQ!WmQ!XnQ!YoQ!ZpQ![qR!f}hROS[]cmnopq}!]Q!PdQ!ReT!g!Q!SqXOS[]cdemnopq}!Q!S!]i^OS[]cmnopq}!]Xy_i!a!cRaO",
  nodeNames: "âš  BoolToken Program Reference ReferenceItem CellToken NameToken VerticalRangeToken HorizontalRangeToken RefErrorToken ReferenceFunctionCall OpenParen Union CloseParen SheetToken QuoteS SheetQuotedToken MultipleSheetsToken MultipleSheetsQuotedToken Constant NumberToken TextToken ErrorToken FunctionCall Function Arguments Argument ConstantArray ArrayColumns ArrayRows ArrayConstant",
  maxTerm: 65,
  nodeProps: [
    ["closedBy", -2,11,24,"CloseParen"],
    ["openedBy", 13,"OpenParen | Function"]
  ],
  skippedNodes: [0],
  repeatNodeCount: 4,
  tokenData: "#Jd~RyOX#rXY/XYZ/XZ]#r]^/X^p#rpq1Xqr#rrs2fstHetu!:kuv#%hvw#&`wx#'Wxy#'`yz#(Wz{#)O{|#)T|}#*t}!O#+l!O!P#,d!P!Q#/r!Q![#/w![!]#1h!]!^#1m!^!_#2e!_!`#5R!`!a#5y!b!c#7o!c!}#9`#O#P#>j#Q#R#G|#R#S#<a#S#T#r#T#o#9`#o#p#Ht#p#q#r#q#r#Il#r;'S#r;'S;=`/R<%lO#r~#uhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rS%dZOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aS&YQqr&`wx%aS&eO`SS&hYOw'Wwx(_xz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'WS'ZYOw'Wwx'yxz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'WS'|Qqr(Swx'WS(XObSS([P;=`<%l'WS(bPwx'WS(hP;=`<%l%a~(ph^~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~*_fOp+spq'Wqs+sst'Wtu+suw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~+vgOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~-dga~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~/OP;=`<%l+s~/UP;=`<%l#r~/^mv~OX#rXY/XYZ/XZ]#r]^/X^p#rpq1Xqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~1^bv~OX%aXY1XYZ1XZ]%a]^1X^p%apq1Xqw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~2ilOp2fpq4aqr=[rs?Xst4atu2fuw4awx6gxz4az{7S{|2f|!O4a!O!P2f!P!Q7S!Q![2f![!]@x!]!a4a!a!b7S!b!}2f!}#Q7S#Q#R4a#R#o2f#o#p4a#p#q2f#q#r4a#r;'S2f;'S;=`H_<%lO2f~4daOr4ars5isw4awx6gxz4az{7S{!P4a!P!Q7S!Q![4a![!]8Y!]!a4a!a!b7S!b!}4a!}#Q7S#Q;'S4a;'S;=`=U<%lO4a~5n]e~Or%ars4asw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~6jWOq7Sqr7trs7fsw7Swx4ax;'S7S;'S;=`7n<%lO7S~7VTOr7Srs7fs;'S7S;'S;=`7n<%lO7S~7kPe~rs7S~7qP;=`<%l7S~7yT`SOr7Srs7fs;'S7S;'S;=`7n<%lO7S~8]aOr9brs:jsw9bwx<lxz9bz{7S{!P9b!P!Q7S!Q![9b![!]7S!]!a9b!a!b7S!b!}9b!}#Q7S#Q;'S9b;'S;=`<f<%lO9b~9eaOr9brs:jsw9bwx;exz9bz{7S{!P9b!P!Q7S!Q![9b![!]7S!]!a9b!a!b7S!b!}9b!}#Q7S#Q;'S9b;'S;=`<f<%lO9b~:o[e~Or'Wrs9bsw'Wwx'yxz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'W~;hWOq7Sqr<Qrs7fsw7Swx9bx;'S7S;'S;=`7n<%lO7S~<VTbSOr7Srs7fs;'S7S;'S;=`7n<%lO7S~<iP;=`<%l9b~<oVOr7Srs7fsw7Swx9bx;'S7S;'S;=`7n<%lO7S~=XP;=`<%l4a~=al^~Op2fpq4aqr=[rs?Xst4atu2fuw4awx6gxz4az{7S{|2f|!O4a!O!P2f!P!Q7S!Q![2f![!]@x!]!a4a!a!b7S!b!}2f!}#Q7S#Q#R4a#R#o2f#o#p4a#p#q2f#q#r4a#r;'S2f;'S;=`H_<%lO2f~?^he~Op#rpq%aqr(krs2fst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~@{lOpBspq9bqrBsrsFkst9btuBsuw9bwx<lxz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~BvlOpBspq9bqrDnrsFkst9btuBsuw9bwx;exz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~Dsla~OpBspq9bqrDnrsFkst9btuBsuw9bwx;exz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~Fpge~Op+spq'Wqr-_rsBsst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~H[P;=`<%lBs~HbP;=`<%l2fVHjf}QOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!f%a!f!gJO!g!i%a!i!jMQ!j!p%a!p!q!)z!q!t%a!t!u!0m!u!v!4X!v!x%a!x!y!6{!y!}%a#Q;'S%a;'S;=`(e<%lO%aTJR]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!k%a!k!lJz!l!}%a#Q;'S%a;'S;=`(e<%lO%aTJ}]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!x%a!x!yKv!y!}%a#Q;'S%a;'S;=`(e<%lO%aTKy[Ow%awx&Vxz%a{!P%a!P!QLo!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aPLrP!Q!RLuPLxPqrL{PMQOfPTMT]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!g%a!g!hM|!h!}%a#Q;'S%a;'S;=`(e<%lO%aTNP]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!v%a!v!wNx!w!}%a#Q;'S%a;'S;=`(e<%lO%aTN{]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!v%a!v!w! t!w!}%a#Q;'S%a;'S;=`(e<%lO%aT! w]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!k%a!k!l!!p!l!}%a#Q;'S%a;'S;=`(e<%lO%aT!!s]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!p%a!p!q!#l!q!}%a#Q;'S%a;'S;=`(e<%lO%aT!#o]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!i%a!i!j!$h!j!}%a#Q;'S%a;'S;=`(e<%lO%aT!$k]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q#R%a#R#S!%d#S;'S%a;'S;=`(e<%lO%aT!%g]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!f%a!f!g!&`!g!}%a#Q;'S%a;'S;=`(e<%lO%aT!&c]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!c%a!c!d!'[!d!}%a#Q;'S%a;'S;=`(e<%lO%aT!'_]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!v%a!v!w!(W!w!}%a#Q;'S%a;'S;=`(e<%lO%aT!(Z]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!c%a!c!d!)S!d!}%a#Q;'S%a;'S;=`(e<%lO%aT!)XZfPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aT!)}`Ow%awx&Vxz%a{!P%a!P!Q!+P!Q![%a![!]&e!]!a%a!b!c%a!c!d!+V!d!w%a!w!x!-v!x!}%a#Q;'S%a;'S;=`(e<%lO%aP!+SP!c!dL{T!+Y]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!o%a!o!p!,R!p!}%a#Q;'S%a;'S;=`(e<%lO%aT!,U]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!g%a!g!h!,}!h!}%a#Q;'S%a;'S;=`(e<%lO%aT!-Q[Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!a!bL{!b!}%a#Q;'S%a;'S;=`(e<%lO%aT!-y^Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!n%a!n!o!.u!o!p!/q!p!}%a#Q;'S%a;'S;=`(e<%lO%aT!.x]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!n%a!n!o!/q!o!}%a#Q;'S%a;'S;=`(e<%lO%aT!/t]Oq%aqr!)Srw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV!0p]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!g%a!g!h!1i!h!}%a#Q;'S%a;'S;=`(e<%lO%aV!1l]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!h%a!h!i!2e!i!}%a#Q;'S%a;'S;=`(e<%lO%aV!2h]Oq%aqr!3arw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV!3fZXROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aT!4[]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!r%a!r!s!5T!s!}%a#Q;'S%a;'S;=`(e<%lO%aT!5W]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!k%a!k!l!6P!l!}%a#Q;'S%a;'S;=`(e<%lO%aT!6S]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!n%a!n!o!.u!o!}%a#Q;'S%a;'S;=`(e<%lO%aT!7O]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!c%a!c!d!7w!d!}%a#Q;'S%a;'S;=`(e<%lO%aT!7z]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!n%a!n!o!8s!o!}%a#Q;'S%a;'S;=`(e<%lO%aT!8v]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!w%a!w!x!9o!x!}%a#Q;'S%a;'S;=`(e<%lO%aT!9r]Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!g%a!g!h!/q!h!}%a#Q;'S%a;'S;=`(e<%lO%a~!:njOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!<`![!]*[!]!a%a!b!c#r!c!}!Bn#Q#R%a#R#T#r#T#o!Bn#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!<chOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!<`![!]!=}!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!>QfOp+spq'Wqs+sst'Wtu!?fuw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![!AQ!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!?igOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![!AQ!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!AVgW~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![!AQ!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!BqjOp#rpq%aqr(krs#rst%atu!Dcuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!FQ![!]!Gq!]!a%a!b!c#r!c!}#!U#Q#R%a#R#T#r#T#o#!U#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!DfhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!FQ![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!FVhT~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!FQ![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!GthOp+spq'Wqs+sst'Wtu!I`uw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!KQ#Q#R'W#R#T+s#T#o!KQ#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!IciOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!KQ#Q#R'W#R#T+s#T#o!KQ#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!KViV~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!Lt#Q#R'W#R#T+s#T#o!Lt#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!LyiV~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!Nh#Q#R'W#R#T+s#T#o!Nh#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!NmgV~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~#!XjOp#rpq%aqr(krs#rst%atu!Dcuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!FQ![!]!Gq!]!a%a!b!c#r!c!}##y#Q#R%a#R#T#r#T#o##y#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~##|hOp#rpq%aqr(krs#rst%atu!Dcuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!FQ![!]!Gq!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rV#%mZ!SROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#&eZ!XROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aT#']P_Pwx%aT#'eZZPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#(]Z]ROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~#)TO!V~~#)Yh!P~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rV#*yZ|ROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#+qZ!QROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~#,ghOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#.R![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~#.Whd~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#.R![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~#/wO!W~~#/|hd~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#.R!Q![#/w![!]!=}!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~#1mO{~T#1rZ!aPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#2j]!ZROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!_%a!_!`#3c!`!a#4Z!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#3hZ!^ROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#4`Z![ROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#5WZxROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#6O]!YROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!_%a!_!`#6w!`!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#6|Z!]ROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~#7th!R~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~#9epU~Op#rpq%aqr(krs#rst%atu!Dcuw%awx&Vxy#;iyz%a{|#r|!O%a!O!P#<a!Q![#A_![!]!Gq!]!a%a!a!b#>j!b!c#r!c!}#Cj#O#P#>j#Q#R%a#R#S#<a#S#T#r#T#o#Cj#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw#?X$Lw;'S#r;'S;=`/R<%lO#r~#;nZh~Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~#<fpU~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxy#;iyz%a{|#r|!O%a!O!P#<a!Q![#<a![!]*[!]!a%a!a!b#>j!b!c#r!c!}#<a#O#P#>j#Q#R%a#R#S#<a#S#T#r#T#o#<a#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw#?X$Lw;'S#r;'S;=`/R<%lO#r~#>oWU~!O!P#>j!Q![#>j!a!b#>j!c!}#>j#O#P#>j#R#S#>j#T#o#>j$Lv$Lw#>j~#?^oU~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#?X!Q![#?X![!]*[!]!a%a!a!b#>j!b!c#r!c!}#?X#O#P#>j#Q#R%a#R#S#?X#S#T#r#T#o#?X#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw#?X$Lw;'S#r;'S;=`/R<%lO#r~#AfpT~U~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxy#;iyz%a{|#r|!O%a!O!P#<a!Q![#A_![!]*[!]!a%a!a!b#>j!b!c#r!c!}#<a#O#P#>j#Q#R%a#R#S#<a#S#T#r#T#o#<a#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw#?X$Lw;'S#r;'S;=`/R<%lO#r~#CopU~Op#rpq%aqr(krs#rst%atu!Dcuw%awx&Vxy#;iyz%a{|#r|!O%a!O!P#<a!Q![#A_![!]!Gq!]!a%a!a!b#>j!b!c#r!c!}#Es#O#P#>j#Q#R%a#R#S#<a#S#T#r#T#o#Es#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw#?X$Lw;'S#r;'S;=`/R<%lO#r~#ExpU~Op#rpq%aqr(krs#rst%atu!Dcuw%awx&Vxy#;iyz%a{|#r|!O%a!O!P#<a!Q![#A_![!]!Gq!]!a%a!a!b#>j!b!c#r!c!}#<a#O#P#>j#Q#R%a#R#S#<a#S#T#r#T#o#<a#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw#?X$Lw;'S#r;'S;=`/R<%lO#rV#HRZ!UROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aT#HyZ!_POw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#IqZ!bROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a",
  tokenizers: [isIntersecop, 0, 1, 2],
  topRules: {"Program":[0,2]},
  specialized: [{term: 6, get: (value, stack) => (isBoolean(value) << 1), external: isBoolean}],
  tokenPrec: 841
});

const spreadsheetLanguage = LRLanguage.define({
    parser: parser.configure({
        props: [
            indentNodeProp.add({
                Application: delimitedIndent({ closing: ')', align: false })
            }),
            foldNodeProp.add({
                Application: foldInside
            }),
            styleTags({
                // References
                'Reference/...': tags.color,
                RefErrorToken: tags.invalid,
                // Constants
                BoolToken: tags.bool,
                ErrorToken: tags.invalid,
                NumberToken: tags.number,
                TextToken: tags.string,
                // Functions
                Function: tags.function(tags.name),
                // Symbols
                OpenParen: tags.name,
                CloseParen: tags.name,
                '[ ]': tags.squareBracket,
                '{ }': tags.brace
            })
        ]
    })
    // languageData: {
    //   commentTokens: { line: ';' }
    // }
});
function spreadsheet() {
    return new LanguageSupport(spreadsheetLanguage);
}

export { setIdiom, spreadsheet, spreadsheetLanguage };
